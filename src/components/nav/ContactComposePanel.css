/* ===== Compose panel pinned to grid rows 2–6, cols 3–7 ===== */

.compose-panel-bg {
  grid-row: 2 / 6;
  grid-column: 3 / 7;
  align-self: stretch;
  justify-self: stretch;
  background: rgba(0, 0, 0, 0.35);
  border-inline: 1px solid rgba(255,255,255,0.15);
  border-block: 1px solid rgba(255,255,255,0.15);
  opacity: 0;
  pointer-events: none;
  transform: translateY(6px);
  transition: opacity 220ms ease, transform 220ms ease;
  z-index: 1004;  /* above submenu bg/list, below the panel */
}
.compose-panel-bg.is-open { opacity: 1; pointer-events: auto; transform: translateY(0); }

.compose-panel {
  grid-row: 2 / 6;
  grid-column: 3 / 7;
  align-self: stretch;
  justify-self: stretch;
  box-sizing: border-box;
  overflow: hidden;                     /* keep children/pseudo inside */
  position: relative;                   /* for ::before / ::after */

  display: grid;
  grid-template-rows: auto 1fr;

  /* Liquid glass base */
  background: rgba(12, 12, 12, 0.15);
  border: 1px solid rgba(255,255,255,0.35);
  border-radius: 14px;
  box-shadow:
    0 18px 40px rgba(0,0,0,.55),
    inset 0 1px 0 rgba(255,255,255,0.25);
  backdrop-filter: blur(10px) saturate(160%);
  -webkit-backdrop-filter: blur(10px) saturate(160%);

  padding: 0.75rem;
  opacity: 0;
  pointer-events: none;
  transform: translateY(10px) scale(0.985);
  transition: opacity 220ms ease, transform 220ms ease;
  z-index: 1006;
}
.compose-panel.is-open { opacity: 1; pointer-events: auto; transform: translateY(0) scale(1); }

/* ----- liquid glass layers ----- */
.compose-panel::before {
  /* soft highlights + vignette */
  content: "";
  position: absolute;
  inset: 0;
  background:
    radial-gradient(1200px 600px at -10% -20%, rgba(255,255,255,0.12), rgba(255,255,255,0) 60%),
    radial-gradient(900px 420px at 115% 0%,  rgba(255,255,255,0.10), rgba(255,255,255,0) 65%),
    linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02));
  mix-blend-mode: screen;
  pointer-events: none;
}
.compose-panel::after {
  /* drifting “liquid” blobs */
  content: "";
  position: absolute;
  inset: -25% -25%;
  background:
    radial-gradient(40% 60% at 25% 30%, rgba(255,255,255,0.10), transparent 60%),
    radial-gradient(55% 45% at 75% 70%, rgba(255,255,255,0.07), transparent 65%),
    conic-gradient(from 0deg at 50% 50%, rgba(255,255,255,0.12), rgba(255,255,255,0) 30%, rgba(255,255,255,0.12) 60%, rgba(255,255,255,0) 100%);
  filter: blur(24px);
  opacity: .65;
  animation: glassDrift 16s ease-in-out infinite alternate;
  pointer-events: none;
}
@keyframes glassDrift {
  0%   { transform: translate(-2%, -1%) rotate(0deg) scale(1.0); }
  100% { transform: translate(2%, 1%)  rotate(0.6deg) scale(1.02); }
}

/* header */
.compose-header {
  display: grid; grid-template-columns: 1fr auto; align-items: center;
  padding: 0.25rem 0.5rem 0.5rem;
  border-bottom: 1px solid rgba(255,255,255,0.22);
}
.compose-header h3 { margin: 0; font-weight: 600; letter-spacing: .02em; }

/* form — ensure children can shrink inside the grid cell */
.compose-form {
  display: grid;
  grid-template-rows: auto auto 1fr auto; /* message grows */
  gap: 0.75rem;
  padding: 0.75rem;
  min-width: 0; min-height: 0; overflow: hidden;
}

.field { display: grid; gap: 0.35rem; min-width: 0; }
.field label { font-size: .85rem; color: rgba(255,255,255,.92); }
.field input,
.field textarea {
  inline-size: 100%;
  max-inline-size: 100%;
  box-sizing: border-box;
  font: inherit;
  color: #fff;
  background: rgba(255,255,255,0.08);
  border: 1px solid rgba(255,255,255,0.35);
  border-radius: 10px;
  padding: 0.65rem 0.75rem;
  outline: none;
}
.field input:focus,
.field textarea:focus {
  border-color: #fff;
  box-shadow: 0 0 0 2px rgba(255,255,255,0.25);
}

/* message area fills remaining space; no manual resize */
.field--body { display: grid; grid-template-rows: auto 1fr; min-height: 0; overflow: hidden; }
.field--body textarea { resize: none; block-size: 100%; overflow: auto; }

/* actions */
.compose-actions {
  display: flex; gap: 0.5rem; justify-content: flex-end; align-items: center;
  padding-top: 0.25rem; border-top: 1px solid rgba(255,255,255,0.14);
}
.send-btn, .ghost-btn, .icon-btn {
  appearance: none; font: inherit; border-radius: 10px;
  padding: 0.55rem 0.9rem; border: 1px solid #fff;
  background: rgba(0,0,0,.35); color: #fff; cursor: pointer;
  transition: transform .15s ease, background .15s ease;
}
.send-btn:hover, .ghost-btn:hover, .icon-btn:hover { transform: translateY(-1px); background: rgba(0,0,0,.55); }
.send-btn { font-weight: 600; }
.ghost-btn { opacity: .9; }
.close-btn { line-height: 1; width: 2rem; height: 2rem; padding: 0; }

/* Small screens — same slot but narrower if your grid changes */
@media (max-width: 768px) {
  .compose-panel-bg,
  .compose-panel { grid-row: 2 / 5; grid-column: 2 / 5; }
}
